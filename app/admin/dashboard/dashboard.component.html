<div>
  <div class="row">
    <!--Dashboard Total sales card view -->

    <!-- Balance -->
    <div class="col-12 col-sm-12 col-md-12 col-lg-6 col-xl-6 col-xxl-3" >
      <nb-card accent="primary" class="bg-primary text-white" [nbSpinner]="cardReportLoading">
        <nb-card-body>
          <div class="d-flex flex-row">
            <nb-icon icon="credit-card-outline" class="card-icon bg-white text-primary" ></nb-icon>
            <div class="mt-1 ms-3" >
              <h6 *ngIf="balanceCard"  class="text-white">{{'general.totalBalance' | translate }}</h6>
              <h4 *ngIf="balanceCard" class="text-white"> <span *ngIf="currency">{{currency.symbol}}</span>{{totalBalance}}</h4>
              <!-- <small class="text-white">{{balanceCard.monthTotal}} this month</small> -->
            </div>
          </div>
          <div class="progress mt-3">
            <div class="progress-bar bg-white" role="progressbar" style="width:100%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
          </div>
          <div class="mt-3">
            <span *ngIf="balanceCard">
              <nb-icon  icon="loader-outline" class="card-icon-growth"></nb-icon>
              {{'general.pending' | translate }}:  <span *ngIf="currency">{{currency.symbol}}</span>{{pendindBalance}}
            </span>
          </div>
        </nb-card-body>
      </nb-card>
    </div>

    <!-- Invoice reports -->
      <div class="col-12 col-sm-12 col-md-12 col-lg-6 col-xl-6 col-xxl-3">
        <nb-card accent="success" [nbSpinner]="cardReportLoading">
          <nb-card-body>
            <div class="d-flex flex-row">
              <nb-icon icon="file-text-outline" class="card-icon bg-success text-white" ></nb-icon>
              <div class="mt-1 ms-3 card-text">
                <h6 *ngIf="invoiceCard">{{'general.totalInvoice' | translate }}</h6>
                <div  *ngIf="invoiceCard"><b>{{totalInvoice}}</b></div>
                <small  class="text-muted"  *ngIf="invoiceCard">{{monthlyInvoice}} {{'general.thisMonth' | translate }}</small>
              </div>
            </div>
            <div class="progress mt-3"  *ngIf="invoiceCard">
              <div class="progress-bar bg-success" role="progressbar" [ngStyle]="{'width': invoiceCard.percentage+'%'}" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            <div class="mt-3">
              <span class="text-success" *ngIf="invoiceCard && invoiceCard.isIncreasing">
                <nb-icon  icon="arrow-upward-outline" class="card-icon-growth"></nb-icon>
                {{invoiceCard.perfomance}}%
              </span>
              <span class="text-danger" *ngIf="invoiceCard && !invoiceCard.isIncreasing">
                <nb-icon  icon="arrow-downward-outline" class="card-icon-growth"></nb-icon>
                {{invoiceCard.perfomance}}%
              </span>
              {{'general.sinceLastMonth' | translate }}
            </div>
          </nb-card-body>
        </nb-card>
      </div>

      <!--Customers reports -->
      <div class="col-12 col-sm-12 col-md-12 col-lg-6 col-xl-6 col-xxl-3">
        <nb-card accent="warning" [nbSpinner]="cardReportLoading">
          <nb-card-body>
            <div class="d-flex flex-row">
              <nb-icon icon="people-outline" class="card-icon bg-warning text-white" ></nb-icon>
              <div class="mt-1 ms-3">
                <h6 *ngIf="customerCard">{{'general.totalCustomer' | translate }}</h6>
                <div  *ngIf="customerCard"><b>{{totalCustomer}}</b></div>
                <small  class="text-muted"  *ngIf="customerCard">{{monthlyCustomer}} {{'general.thisMonth' | translate }}</small>
              </div>
            </div>
            <div class="progress mt-3"  *ngIf="customerCard">
              <div class="progress-bar bg-warning" role="progressbar" [ngStyle]="{'width': customerCard.percentage+'%'}" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            <div class="mt-3">
              <span class="text-success" *ngIf="customerCard && customerCard.isIncreasing">
                <nb-icon  icon="arrow-upward-outline" class="card-icon-growth"></nb-icon>
                {{customerCard.perfomance}}%
              </span>
              <span class="text-danger" *ngIf="customerCard && !customerCard.isIncreasing">
                <nb-icon  icon="arrow-downward-outline" class="card-icon-growth"></nb-icon>
                {{customerCard.perfomance}}%
              </span>
              {{'general.sinceLastMonth' | translate }}
            </div>
          </nb-card-body>
        </nb-card>
      </div>

      <!--Estimates -->
      <div class="col-12 col-sm-12 col-md-12 col-lg-6 col-xl-6 col-xxl-3">
        <nb-card accent="info" [nbSpinner]="cardReportLoading">
          <nb-card-body>
            <div class="d-flex flex-row">
              <nb-icon icon="file-outline" class="card-icon bg-info text-white" ></nb-icon>
              <div class="mt-1 ms-3">
                <h6 *ngIf="estimateCard">{{'general.totalEstimate' | translate }}</h6>
                <div  *ngIf="estimateCard"><b>{{totalEstimate}}</b></div>
                <small  class="text-muted"  *ngIf="estimateCard">{{monthlyEstimate}} {{'general.thisMonth' | translate }}</small>
              </div>
            </div>
            <div class="progress mt-3"  *ngIf="estimateCard">
              <div class="progress-bar bg-info" role="progressbar" [ngStyle]="{'width': estimateCard.percentage+'%'}" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            <div class="mt-3">
              <span class="text-success" *ngIf="estimateCard && estimateCard.isIncreasing">
                <nb-icon  icon="arrow-upward-outline" class="card-icon-growth"></nb-icon>
                {{estimateCard.perfomance}}%
              </span>
              <span class="text-danger" *ngIf="estimateCard && !estimateCard.isIncreasing">
                <nb-icon  icon="arrow-downward-outline" class="card-icon-growth"></nb-icon>
                {{estimateCard.perfomance}}%
              </span>
              {{'general.sinceLastMonth' | translate }}
            </div>
          </nb-card-body>
        </nb-card>
      </div>
  </div>


  <div class="row">
    <!-- Chart panel -->
    <div  class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 col-xxl-12">
      <charts-panel></charts-panel>
    </div>

    <!-- Last transactions -->
    <!-- <div  class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 col-xxl-4">
      <nb-card accent="primary" class="last-transactions" [nbSpinner]="transactionLoading">
        <nb-card-header>
          {{ 'general.transactions' | translate }}
          <span class="float-end"><a nbButton size="small" status="primary"  routerLink="/dashboard/transaction-list">{{ 'general.viewAll' | translate }}</a></span>
        </nb-card-header>
        <nb-card-body>
          <table class="table table-striped table-borderless">
            <thead>
              <tr>
                <th class="date" scope="col">{{ 'general.date' | translate }}</th>
                <th class="category" scope="col">{{ 'general.category' | translate }}</th>
                <th class="amount" scope="col">{{ 'general.amount' | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of transactions">
                <td>
                  {{item.date | date: 'MMM d, y, HH:mm'}}
                </td>
                <td>
                  <span *ngIf="item.category === 'Income'"  class="badge badge-primary">
                    {{item.category}}
                  </span>
                  <span *ngIf="item.category === 'Expense'"  class="badge badge-warning">
                    {{item.category}}
                  </span>
                  <span *ngIf="item.category === 'ManualJournal'" class="badge badge-info">
                    {{item.category}}
                  </span>
                </td>
                <td class="text-primary">
                  <span *ngIf="currency">{{currency.symbol}}</span>{{item.amount}}
                </td>
              </tr>
            </tbody>
          </table>
        </nb-card-body>
      </nb-card>
    </div> -->

    <!-- Last invoices -->
    <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 col-xxl-6">
      <nb-card accent="primary" [nbSpinner]="invoiceCardLoading" class="last-invoices">
        <nb-card-header>
          <span>{{ 'general.recentInvoices' | translate }}</span>
          <span class="float-end"><a nbButton size="small" status="primary" routerLink="/dashboard/invoice-list" >{{ 'general.viewAll' | translate }}</a></span>
        </nb-card-header>
        <nb-card-body>
          <div class="table-responsive mt-4">
            <table class="table table-striped table-borderless">
              <thead>
                <tr>
                  <th class="customer" scope="col">{{ 'general.customer' | translate }}</th>
                  <th class="total-amount" scope="col">{{ 'general.amount' | translate }}</th>
                  <th class="issue-date" scope="col">{{ 'general.dueDate' | translate }}</th>
                  <th class="status" scope="col">{{ 'general.status' | translate }}</th>
                  <th>{{ 'table.actions' | translate }}</th>
                </tr>
              </thead>
              <tbody *ngIf="invoices">
                <tr *ngFor="let item of invoices">
                  <td>
                    <a *ngIf="item.customer" >
                      <nb-user size="medium"
                        name="{{item.customer.name}}"
                        title="{{item.customer.email}}"
                        [showTitle]="true">
                      </nb-user>
                    </a>
                  </td>
                  <td class="text-primary">
                    <span *ngIf="item.currency">{{item.currency.symbol}}</span>{{item.totalAmount}}

                  </td>
                  <td [ngClass]="item.dueDateIsPassed ? 'text-danger':'' ">
                    {{item.issueDate | date: 'MMM d, y, HH:mm'}}
                  </td>
                  <td>
                    <span class="badge {{item.badgeStatus}}">
                      {{item.status}}
                    </span>
                  </td>
                  <td>
                    <a nbButton ghost status="basic" [routerLink]="['/dashboard/invoice/details',item.id]">
                      <nb-icon icon="eye-outline"></nb-icon>
                    </a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </nb-card-body>
      </nb-card>
    </div>

    <!-- Dashboard pie chart ng2-chart.js-->
    <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 col-xxl-6">
      <app-pie-echart></app-pie-echart>
    </div>

    <!-- Last estimates -->
    <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 col-xxl-6" >
      <nb-card accent="primary" [nbSpinner]="estimateCardLoading" class="last-estimates">
        <nb-card-header>
          <span>{{ 'general.recentEstimates' | translate }}</span>
          <span class="float-end"><a nbButton size="small" status="primary"  routerLink="/dashboard/proposal-list">{{ 'general.viewAll' | translate }}</a></span>
        </nb-card-header>
        <nb-card-body>
          <div class="table-responsive mt-4">
            <table class="table table-striped table-borderless">
              <thead>
                <tr>
                  <th class="customer" scope="col">{{ 'general.customer' | translate }}</th>
                  <th class="total-amount" scope="col">{{ 'general.amount' | translate }}</th>
                  <th class="issue-date" scope="col">{{ 'general.dueDate' | translate }}</th>
                  <th class="status" scope="col">{{ 'general.status' | translate }}</th>
                  <th>{{ 'table.actions' | translate }}</th>
                </tr>
              </thead>
              <tbody *ngIf="estimates">
                <tr *ngFor="let item of estimates">
                  <td>
                    <a *ngIf="item.customer">
                      <nb-user size="medium"
                        name="{{item.customer.name}}"
                        title="{{item.customer.email}}"
                        [showTitle]="true">
                      </nb-user>
                    </a>
                  </td>
                  <td class="text-primary">
                    <span *ngIf="item.currency">{{item.currency.symbol}}</span>{{item.totalAmount}}
                  </td>
                  <td [ngClass]="item.dueDateIsPassed ? 'text-danger':'' ">
                    {{item.issueDate | date: 'MMM d, y, HH:mm'}}
                  </td>
                  <td>
                    <span class="badge {{item.badgeStatus}}">
                      {{item.status}}
                    </span>
                  </td>
                  <td>
                    <a nbButton ghost status="basic" [routerLink]="['/dashboard/proposal/details',item.id]">
                      <nb-icon icon="eye-outline"></nb-icon>
                    </a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </nb-card-body>
      </nb-card>
    </div>

    <!-- Last Bills -->
    <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 col-xxl-6" >
      <nb-card accent="primary" [nbSpinner]="billCardLoading" class="last-estimates">
        <nb-card-header>
          <span>{{ 'general.recentBills' | translate }}</span>
          <span class="float-end"><a nbButton size="small" status="primary"  routerLink="/dashboard/bill-list">{{ 'general.viewAll' | translate }}</a></span>
        </nb-card-header>
        <nb-card-body>
          <div class="table-responsive mt-4">
            <table class="table table-striped table-borderless">
              <thead>
                <tr>
                  <th class="vendor" scope="col">{{ 'general.vendor' | translate }}</th>
                  <th class="total-amount" scope="col">{{ 'general.amount' | translate }}</th>
                  <th class="issue-date" scope="col">{{ 'general.dueDate' | translate }}</th>
                  <th class="status" scope="col">{{ 'general.status' | translate }}</th>
                  <th>{{ 'table.actions' | translate }}</th>
                </tr>
              </thead>
              <tbody *ngIf="bills">
                <tr *ngFor="let item of bills">
                  <td>
                    <a *ngIf="item.vendor">
                      <nb-user size="medium"
                        name="{{item.vendor.name}}"
                        title="{{item.vendor.email}}"
                        [showTitle]="true">
                      </nb-user>
                    </a>
                  </td>
                  <td class="text-primary">
                    <span *ngIf="item.currency">{{item.currency.symbol}}</span>{{item.totalAmount}}
                  </td>
                  <td [ngClass]="item.dueDateIsPassed ? 'text-danger':'' ">
                    {{item.issueDate | date: 'MMM d, y, HH:mm'}}
                  </td>
                  <td>
                    <span class="badge {{item.badgeStatus}}">
                      {{item.status}}
                    </span>
                  </td>
                  <td>
                    <a nbButton ghost status="basic" [routerLink]="['/dashboard/bill/details',item.id]">
                      <nb-icon icon="eye-outline"></nb-icon>
                    </a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </nb-card-body>
      </nb-card>
    </div>

  </div>

  <div class="row" >
    <div class="col-12" >
      <ng-container *ngIf="goals != null && goals.length > 0">
        <nb-card accent="primary">
          <nb-card-body>
            <h5>{{'general.goals' | translate }}</h5>
            <div  class="mt-5" *ngFor="let item of goals">
              <div class="row">
                <div class="col-6">
                  <h6>{{'general.amountToReach' | translate }}: <span class="text-primary">${{item.amount}}</span></h6>
                </div>
                <div class="col-3 text-end">
                  <b>{{'general.startAt' | translate }}: <span class="primary">{{item.from | date: 'MMM d, y, HH:mm'}}</span></b>
                </div>
                <div class="col-3 text-end">
                  <b>{{'general.endAt' | translate }}: <span class="primary">{{item.to | date: 'MMM d, y, HH:mm'}}</span></b>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col-12">
                  <nb-progress-bar [value]="item.value" [status]="item.status" [displayValue]="false"></nb-progress-bar>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col-6">
                  <b *ngIf="item.name">{{'general.name' | translate }}: {{item.name}}</b>
                </div>
                <div class="col-6">
                  <a class="float-end me-2" [routerLink]="['/dashboard/goal/edit', item.id]" nbButton status="warning" size="tiny">
                    <nb-icon icon="edit-outline"></nb-icon> {{'form.edit' | translate }}
                  </a>
                </div>
              </div>
            </div>
          </nb-card-body>
        </nb-card>
      </ng-container>
    </div>
  </div>
</div>
